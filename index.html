<!DOCTYPE html>
<htnl>
    <head>
        <title></title>
        <style>
        
        </style>
    </head>

    <body>

        <form id="add-form">
            <label>Name: <input id="item-name" type="text" placeholder="Item Name"></label>
            <label>Price: <input id="item-price" type="number" step="0.01"></label>
            <button type="submit">Add Item</button>
        </form>

        <div id="cart-qty">
            
        </div>

        <ul id="item-list">
            <!--Cart Items-->
        </ul>

        <div id="cart-total">

        </div>

        <script>
            const itemList = document.getElementById('item-list')
            const cartQty = document.getElementById('cart-qty')
            const cartTotal = document.getElementById('cart-total')
            const addForm = document.getElementById('add-form')
            const itemName = document.getElementById('item-name')
            const itemPrice = document.getElementById('item-price')

            const cart = [ ]

            //----------------------------------
            //handle clicks on list
            itemList.onclick = function(e) {
                // console.log("Clicked List!!!")
                // console.log(e.target)
                if (e.target && e.target.classList.contains('remove')) {
                    const name = e.target.dataset.name // data-name="????"
                    removeItem(name)
                }

            }



            // ------------------------------
            // handle ad form submit
            addForm.onsubmit =  function(e) {
                e.preventDefault()
                const name = itemName.value
                const price = itemPrice.value
                addItem(name, price)

            }


            // Add Item
            //-------------------------------------------
            function addItem(name, price) {
                for (let i =0; i < cart.length; i += 1) {
                    if (cart[i].name === name) {
                        cart[i].qty += 1
                        showItems()
                        return
                    }
                }

                const item = {name, price, qty: 1}
                cart.push(item)
                showItems()
            }

            //Show Items
            //-----------------------------------------
            function showItems() {
                const qty = getQty()

                cartQty.innerHTML = `You have ${qty} items in your cart`

                let itemStr = ''
               for (let i=0; i < cart.length; i+= 1) {
                //    console.log(` ${cart[i].name} ${cart[i].price} x ${cart[i].qty} `)
                   
                    // { name: 'Apple', price: 0.99, qty: 3 }
                    const { name, price, qty } = cart[i]

                   itemStr += `<li>
                   ${name} $${price} x ${qty} = ${qty * price}
                   <button class="remove" data-name="${name}">Remove</button>
                   </li>`
                }
                itemList.innerHTML = itemStr

                cartTotal.innerHTML = `Total in cart: $${getTotal()}`
            }

            
            // Get Quantity
            // ---------------------------------------------
            function getQty() {
                let qty = 0
                for (let i = 0; i< cart.length; i += 1) {
                    qty += cart[i].qty
                }
                return qty

            }
            
            //Get Total
            //----------------------------------------------
            function getTotal() {
                let total = 0
                for (let i = 0; i < cart.length; i += 1) {
                    total += cart[i].price * cart[i].qty
                }
               
                return total.toFixed(2)
            }

            //Remove Item
            //------------------------------------------------
            function removeItem(name, qty = 0) {
                for (let i = 0; i < cart.length; i += 1) {
                    if (cart[i].name === name) {
                        if (qty > 0) {
                            cart[i].qty -= qty
                        }
                        if(cart[i].qty < 1 || qty === 0) {
                            cart.splice(i, 1)
                        }
                        showItems()
                        return
                    }
                }
            }

            //--------------------------------------------------
            addItem('Apple', 0.99)
            addItem('Orange', 1.29)
            addItem('Opinion', 0.02)
            addItem('Apple', 0.99)
            addItem('Frisbee', 9.92)
            addItem('Apple', 0.99)
            addItem('Orange', 0.99)

            // showItems()


            // removeItem('Apple', 1)
            // removeItem('Frisbee')


            // showItems()
        </script>
    </body>
</htnl>